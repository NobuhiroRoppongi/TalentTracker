{% extends "layout.html" %}

{% block content %}


<!-- Skill Matrix -->

<div class="row mb-4">
    <div class="col-12">
        <div class="skill_matrix_charts">
            {% include "partials/skill_matrix.html" %}
        </div>
        <!-- Summary Stats -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="stat-card">
                    <div class="stat-value" id="total-score">0</div>
                    <div class="stat-label">合計スキルスコア</div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="stat-card">
                    <div class="stat-value" id="avg-score">0.00</div>
                    <div class="stat-label">平均スキルスコア</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Top Filters Bar -->
<div class="row mb-4">
    <div class="col-12">
        <div class="top-filters-container">
            {% include "partials/top_filters.html" %}
        </div>
    </div>
</div>

<!-- Main Dashboard Content -->
<div class="row">
    <div class="col-12">
        <!-- Active Filters Display -->
        <div class="active-filters-container mb-4">
            <div class="active-filter-label">アクティブなフィルター:</div>
            <div id="active-filters">
                <!-- Active filters will be added here dynamically -->
            </div>
            <div id="no-filters-message" class="text-muted small">フィルターが選択されていません。すべてのデータが表示されています。</div>
        </div>

        <!-- Employee Selection -->
        <div class="dashboard-card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">従業員一覧</h5>
                <div class="d-flex align-items-center">
                    <span class="me-2">選択済み: <span id="selection-count">0</span></span>
                    <button id="clear-selection-btn" class="btn btn-sm btn-outline-secondary">
                        <i class="bi bi-x-circle"></i> 選択解除
                    </button>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover employee-table mb-0">
                        <thead>
                            <tr>
                                <th class="text-center" style="width: 11%;"">名前</th>
                                <th class="text-center" style="width: 11%;">オフィス</th>
                                <th class="text-center" style="width: 11%;">平均スキル</th>
                                <th class="text-center" style="width: 11%;">タイプ</th>
                                <th class="text-center" style="width: 26%;">キャパシティ</th>
                                <th class="text-center" style="width: 30%;">アクション</th>
                            </tr>
                        </thead>
                        <tbody id="employee-table-body">
                            <!-- Employee rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>


    </div>
</div>

<!-- Employee Details Modal -->
<div class="modal fade employee-details-modal" id="employee-details-modal" tabindex="-1" aria-labelledby="employeeDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="employeeDetailsModalLabel">従業員詳細</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Employee details will be loaded here dynamically -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
            </div>
        </div>
    </div>
</div>

<!-- Skill Selection Modal -->
<div class="modal fade" id="skill-selection-modal" tabindex="-1" aria-labelledby="skillSelectionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="skillSelectionModalLabel">スキル選択</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="skill-selection-content">
                    <!-- Skill checkboxes will be loaded here dynamically -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="skill-modal-cancel">キャンセル</button>
                <button type="button" class="btn btn-primary" id="skill-modal-apply">適用</button>
            </div>
        </div>
    </div>
</div>

<!-- Projects Modal -->
<div class="modal fade" id="projects-modal" tabindex="-1" aria-labelledby="projectsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="projectsModalLabel">進行中のプロジェクト</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="projects-content">
                    <!-- Project information will be loaded here dynamically -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
            </div>
        </div>
    </div>
</div>

<!-- Personality Traits Modal -->
<div class="modal fade" id="personality-modal" tabindex="-1" aria-labelledby="personalityModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="personalityModalLabel">性格特性</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="personality-content">
                    <!-- Personality traits will be loaded here dynamically -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
